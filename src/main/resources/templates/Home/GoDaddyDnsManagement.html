<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Production UI</title>
    <link href="/assets/plugins/simplebar/css/simplebar.css" rel="stylesheet"/>
    <link href="/assets/plugins/perfect-scrollbar/css/perfect-scrollbar.css" rel="stylesheet"/>
    <link href="/assets/plugins/metismenu/css/metisMenu.min.css" rel="stylesheet"/>
    <link href="/assets/plugins/datatable/css/dataTables.bootstrap5.min.css" rel="stylesheet"/>
    <!-- loader-->
    <!--    <link href="/assets/css/pace.min.css" rel="stylesheet"/>-->
    <!--    <script src="/assets/js/pace.min.js"></script>-->
    <!-- Bootstrap CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/bootstrap-extended.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <link href="/assets/css/app.css" rel="stylesheet">
    <link href="/assets/css/icons.css" rel="stylesheet">

    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous"
    />
    <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"
    ></script>
    <link
            th:href="@{/assets/plugins/datatable/css/dataTables.bootstrap5.min.css}"
            rel="stylesheet"
    />
    <!-- Include Font Awesome CSS -->
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
</head>

<style>
    .status-button {
        border: none;
        color: #000000;
        padding: 5px 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 14px;
        margin: 4px 2px;
        cursor: pointer;
    }

    #console {
        width: 100%;
        height: 90vh;
        overflow-y: auto;
        padding: 10px;
        border: 1px solid lime;
    }

    .status-green {
        background-color: green;
    }

    .status-red {
        background-color: red;
    }

    /*body {*/
    /*    font-family: Arial, sans-serif;*/
    /*    background-color: #f8f9fa;*/
    /*}*/

    h1 {
        color: #343a40;
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    .table {
        background-color: #ffffff;
        border-radius: 5px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .table thead th {
        background-color: #343a40;
        color: #ffffff;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .table tbody tr:hover {
        background-color: #f1f1f1;
    }

    .table td,
    .table th {
        vertical-align: middle;
        padding: 12px;
    }

    /* Table Row Colors */
    tr.active {
        background-color: #d4fdd4; /* Light green for Active */
    }

    tr.expired {
        background-color: #fdd4d4; /* Light red for Expired */
    }

    /* Tooltip Styling */
    .tooltip {
        position: relative;
        display: inline-block;
        cursor: pointer;
    }

    .tooltip .tooltiptext {
        visibility: hidden;
        width: 120px;
        background-color: #333;
        color: #fff;
        text-align: center;
        padding: 5px;
        border-radius: 5px;
        position: absolute;
        z-index: 1;
        bottom: 125%; /* Position above the icon */
        left: 50%;
        margin-left: -60px;
        opacity: 0;
        transition: opacity 0.3s;
    }

    .tooltip:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
    }

    .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background-color: #8eb9b9;
        padding: 20px 40px; /* Increased padding for more height and width */
        height: 100px; /* Increased height */
    }

    /* Styling for the image */
    .header img {
        height: 70px; /* Adjusted height of the image */
    }

    /* Styling for the center title */
    .header h1 {
        margin: 0;
        font-size: 28px; /* Increased font size */
        flex-grow: 1;
        text-align: center;
    }
</style>
<body>

<header class="header m-1">
    <!-- Image on the left -->
    <img src="/assets/GC Cloud Logo.png" alt="Logo">

    <!-- Centered text -->
    <h1 style="
        display: flex;
        justify-content: center;
        font-weight: 700;
        font-family: fangsong;

      ">Web Production Portal</h1>
</header>

<!--<div class="card">-->
<!--    <div class="card-body">-->
<!--        <div class="table-responsive">-->
<!--            <table id="example2" class="table table-striped table-bordered">-->
<div class="container-fluid">

    <!-------------------------------------GoDaddy  DNS Manager Started ---------------------------------------------------------->
    <div class="container mt-5">
        <h1 class="text-center mb-4">GoDaddy DNS Management</h1>
        <div class="summary">
            <p>Total Domains: <span id="total-domains">0</span></p>
            <label for="status-filter">Filter by Status: </label>
            <select id="status-filter">
                <option value="all">All</option>
                <option value="active">Active</option>
                <option value="expired">Expired</option>
            </select>
        </div>
        <table class="table">
            <thead>
            <tr>
                <th>Domain Name</th>
                <th>Expiration Date</th>
                <th>Auto-Renew</th>
                <th>Domain Privacy</th>
                <th>Lock</th>
                <th>Status</th>
                <th>Actions</th>
                <th>Generate CSR</th>
                <th>Verify Domain</th>
                <th>Download Crt</th>
            </tr>
            </thead>
            <tbody id="domain-list"></tbody>
        </table>
    </div>

    <!-------------------------------------Go Daddy DNS Manager Ended ---------------------------------------------------------->

</div>


<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"
></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
<script>
    $(document).ready(function () {
        var table = $("#productionTable").DataTable({
            dom:
                '<"top row px-3 py-1 border border-2 border-grey bg-gradient-primary "' +
                // '   <"col-lg-2 col-md-2 col-sm-12 p-1 d-flex align-items-center"l>' +
                '   <"col-lg-6 col-md-6 col-sm-12 p-1 d-flex align-items-center"B>' +
                '   <"col-lg-6 col-md-6 col-sm-12 p-1 d-flex align-items-center"f>' +
                '   <"clear">>rt' +
                '<"bottom row px-5"' +
                '  <"col-lg-6 col-md-6 col-sm-12"i>' +
                '  <"col-lg-6 col-md-6 col-sm-12"p>' +
                '   <"clear">>',
            paging: false,
            scrollX: true,

            lengthChange: false,
            buttons: ["copy", "excel", "pdf", "print"],
            initComplete: function () {
                $(".dt-buttons button").removeClass("btn-light");
                $(".dt-buttons button").addClass("m-0 btn-sm btn-outline-dark");
                $(".dataTables_filter").addClass("w-100 text-center d-flex");
                $(".dataTables_filter input").addClass("w-75 border-2 border-info ");
                $(".dataTables_filter label").addClass(
                    "w-100 text-center align-items-center justify-content-around d-flex m-0 text-dark font-weight-bold"
                );
                $(".dt-buttons.btn-group").css("width", "-webkit-fill-available");

            },
        });

        table
            .buttons()
            .container()
            .appendTo("#productionTable_wrapper .col-md-6:eq(0)");
    });
</script>

<script>
    function parallax_height() {
        var scroll_top = $(this).scrollTop();
        var sample_section_top = $(".sample-section").offset().top;
        var header_height = $(".sample-header-section").outerHeight();
        $(".sample-section").css({"margin-top": header_height});
        $(".sample-header").css({height: header_height - scroll_top});
    }

    parallax_height();
    $(window).scroll(function () {
        parallax_height();
    });
    $(window).resize(function () {
        parallax_height();
    });
</script>

<!---------------------------Script For SQL Backup Started----------------------->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const totalDomains = document.getElementById('total-domains');
        const domainList = document.getElementById('domain-list');
        const statusFilter = document.getElementById('status-filter');

        const fetchDomains = async (status = 'all') => {
            try {
                const response = await fetch('/data/getdomains'); // Replace with your backend endpoint
                const domains = await response.json();
                console.log("domain list:", domains);

                const filteredDomains = status === 'all'
                    ? domains
                    : domains.filter(domain => domain.status.toLowerCase() === status);

                totalDomains.textContent = filteredDomains.length;
                renderDomainList(filteredDomains);
            } catch (error) {
                console.error('Error fetching domains:', error);
            }
        };

        const renderDomainList = (domains) => {
            domainList.innerHTML = domains.map(domain => `
        <tr class="${domain.status.toLowerCase()}">
            <td>${domain.domain}</td>
            <td>${new Date(domain.expires).toLocaleDateString() || 'N/A'}</td>
            <td>${domain.renewAuto ? 'On' : 'Off'}</td>
            <td>${domain.privacy ? 'Enabled' : 'Disabled'}</td>
            <td>${domain.locked ? 'On' : 'Off'}</td>
            <td>${domain.status}</td>
            <td>
                <button onclick="manageDomain('${domain.domain}')">Manage</button>
            </td>
              <td>
                <button class="btn btn-success" onclick="generateCSR('${domain.domain}')">Generate CSR</button>
            </td>
             <td>
                <button class="btn btn-danger" onclick="verifyDomainByZeroSsl('${domain.domain}')">Verify Domain</button>
            </td>
             <td>
                <button class="btn btn-warning" onclick="downlaodZeroSslCertificate('${domain.domain}')">Download Certificate</button>
            </td>
        </tr>
    `).join('');
        };

        statusFilter.addEventListener('change', (e) => {
            fetchDomains(e.target.value);
        });

        fetchDomains();
    });


    const manageDomain = (domain) => {
        alert(`Manage domain: ${domain}`);
    };
    // Function to Generate CSR Certificate started ----------------
    const generateCSR = async (domain) => {
        debugger;
        try {
            const response = await fetch(`/data/createSslCertificate?domain=${encodeURIComponent(domain)}`, {
                method: 'POST'
            });

            if (response.ok) {
                const result = await response.json();
                console.log('CSR Generated:', result);
                alert(`CSR generated for domain: ${domain}\n\nCSR:\n${result.csr}`);
            } else {
                console.error('Error generating CSR:', response.statusText);
                alert('Failed to generate CSR. Please try again.');
            }
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred while generating CSR.');
        }
    };
    // Function to Generate CSR Certificate Ended ----------------

    // Function to verify Domain By ZeroSsl started ----------------
    const verifyDomainByZeroSsl = async (domain) => {
        debugger;
        try {
            const response = await fetch(`/data/verifyDomainByZeroSsl?domain=${encodeURIComponent(domain)}`, {
                method: 'POST'
            });

            if (response.ok) {
                const result = await response.json();
                console.log('CSR Generated:', result);
                alert(`CSR generated for domain: ${domain}\n\nCSR:\n${result.csr}`);
            } else {
                console.error('Error generating CSR:', response.statusText);
                alert('Failed to Verify Domain. Please try again.');
            }
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred while generating CSR.');
        }
    };
    // Function to verify Domain By ZeroSsl Ended ----------------


    // Function to Downlaod Zero Ssl Certificate started ----------------
    const downlaodZeroSslCertificate = async (domain) => {
        debugger;
        try {
            const response = await fetch(`/data/downlaodZeroSslCertificate?domain=${encodeURIComponent(domain)}`, {
                method: 'POST'
            });

            if (response.ok) {
                const result = await response.json();
                console.log('CSR Generated:', result);
                alert(`CSR generated for domain: ${domain}\n\nCSR:\n${result.csr}`);
            } else {
                console.error('Error generating CSR:', response.statusText);
                alert('Failed to Verify Domain. Please try again.');
            }
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred while generating CSR.');
        }
    };
    // Function to Downlaod Zero Ssl Certificate   Ended ----------------


</script>
<!---------------------------Script For SQL Backup Ended----------------------->

</body>
</html>
